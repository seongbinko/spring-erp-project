package kr.co.jhta.erp.web.cotroller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import kr.co.jhta.erp.dto.StoreManagementDto;
import kr.co.jhta.erp.service.CategoryService;
import kr.co.jhta.erp.service.StoreManagementService;
import kr.co.jhta.erp.service.StoreService;
import kr.co.jhta.erp.vo.Category;

@Controller
@RequestMapping("/store")
public class StoreController {


	@Autowired
	private StoreService storeService;
	
	@Autowired
	private StoreManagementService storeManagementService;
	
	@Autowired
	private CategoryService categoryService;
	
	
	// 상위카테고리 번호에 해당하는 카테고리를 JSON으로 반환한다.
	@GetMapping("/uppercategory.erp")
	@ResponseBody
	public Category getUpperCategory(@RequestParam("categoryno") int categoryNo) {
		Category category = categoryService.getUpperCategoryBySubcategoryNo(categoryNo);
		return category;
	}
	
	// 상위카테고리 번호를 전달받아 하위카테고리 리스트를 JSON으로 받는다.
	@GetMapping("/subcategory.erp")
	@ResponseBody
	public List<Category> getSubCategories(@RequestParam("uppercateno") int upperCateNo) {
		List<Category> subCategories = categoryService.getSubCategoriesByUpperCateNo(upperCateNo);
		return subCategories;	
	}
	
	
	
	@GetMapping("/main.erp")
	public String storeMain() {
		
		return "store/main";
	}
	
	@GetMapping("/findStore.erp")
	public String findStore() {
		
		return "store/selectfindstoremain";
	}
	
	@GetMapping("/order.erp")
	public String order() {
		
		return "store/orderform";
	}
	
	@GetMapping("/orderhistory.erp")
	public String orderHistory() {
		
		return "store/orderhistory";
	}
	@GetMapping("/ordermodify.erp")
	public String orderModify() {
		
		return "store/ordermodify";
	}
	@GetMapping("/statistic.erp")
	public String storeStatistic() {
		
		return "store/storestatistic";
	}
	@GetMapping("/stockinformation.erp")
	public String stockInformation() {
		
		return "store/stockinformation";
	}
	@GetMapping("/transactioninformation.erp")
	public String transactionInformation() {
		
		return "store/transactioninformation";
	}
	
	@RequestMapping("/storeseachdetail.erp")
	@ResponseBody
	public StoreManagementDto storeSeachDetail(@RequestParam("no") int storeNo) {
		return storeManagementService.getStoreDetailByNo(storeNo);
		
	}
	
	@RequestMapping("/orderstoremodal.erp")
	@ResponseBody
	public List<StoreManagementDto> orderstoremodal() {
		
		return storeManagementService.getAllStoreDetails();
	}
	
}
